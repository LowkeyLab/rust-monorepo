#!/usr/bin/env bash
#MISE description="Generate SeaORM entities from database schema"
set -euo pipefail

echo "ğŸ”§ Starting Docker Compose services..."
docker compose up -d

echo "â³ Waiting for PostgreSQL to be ready..."
sleep 5

echo "ğŸ—ï¸ Installing SeaORM CLI if not present..."
if ! command -v sea-orm-cli &> /dev/null; then
    cargo install sea-orm-cli
fi

echo "ğŸ—ƒï¸ Generating entities from database schema..."

# Generate entities using SeaORM CLI
sea-orm-cli generate entity \
    -u "${DATABASE_URL}" \
    -o src/server/entities \

echo "âœ… Entity generation completed successfully!"
echo "ğŸ“ Generated entities are located in src/entities/"
